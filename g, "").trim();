const parsedResponse = JSON.parse(text);

return {
  questionText: parsedResponse.questionText,
  answer: parsedResponse.answer || parsedResponse.correctChoice,
  explanation: parsedResponse.explanation,
  choices: parsedResponse.choices,
  correctChoice: parsedResponse.correctChoice,
};

} catch (error) {
  console.error("Error generating content with Gemini:", error);
  if (error instanceof Error) {
    throw new Error(`AI Content Generation Failed: ${error.message}`);
  }
  throw new Error("Failed to generate question using AI due to an unknown error.");
}